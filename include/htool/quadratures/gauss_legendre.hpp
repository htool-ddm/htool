#ifndef HTOOL_QUADRATURES_GAUSS_LEGENDRE_HPP
#define HTOOL_QUADRATURES_GAUSS_LEGENDRE_HPP

#include <array>
#include <cstddef>
namespace htool {

template <typename T>
struct GaussLegendreRule {
    std::size_t degree;
    std::size_t nb_points;
    const T *x;
    const T *w;
};

// order 1
constexpr double gl1_x[] = {0.0};
constexpr double gl1_w[] = {2.0};

// order 2
constexpr double gl2_x[] = {
    -0.5773502691896257,
    0.5773502691896257};
constexpr double gl2_w[] = {
    1.0,
    1.0};

// order 3
constexpr double gl3_x[] = {
    -0.7745966692414834,
    0.0,
    0.7745966692414834};
constexpr double gl3_w[] = {
    0.5555555555555556,
    0.8888888888888888,
    0.5555555555555556};

// -------- order 4 --------
constexpr double gl4_x[] = {
    -0.8611363115940526,
    -0.3399810435848563,
    0.3399810435848563,
    0.8611363115940526};

constexpr double gl4_w[] = {
    0.3478548451374539,
    0.6521451548625461,
    0.6521451548625461,
    0.3478548451374539};

// ---------- order 5 ----------
constexpr double gl5_x[] = {
    -0.9061798459386640,
    -0.5384693101056831,
    0.0,
    0.5384693101056831,
    0.9061798459386640};
constexpr double gl5_w[] = {
    0.2369268850561891,
    0.4786286704993665,
    0.5688888888888889,
    0.4786286704993665,
    0.2369268850561891};

// ---------- order 6 ----------
constexpr double gl6_x[] = {
    -0.9324695142031521,
    -0.6612093864662645,
    -0.2386191860831969,
    0.2386191860831969,
    0.6612093864662645,
    0.9324695142031521};
constexpr double gl6_w[] = {
    0.1713244923791704,
    0.3607615730481386,
    0.4679139345726910,
    0.4679139345726910,
    0.3607615730481386,
    0.1713244923791704};

// ---------- order 7 ----------
constexpr double gl7_x[] = {
    -0.9491079123427585,
    -0.7415311855993945,
    -0.4058451513773972,
    0.0,
    0.4058451513773972,
    0.7415311855993945,
    0.9491079123427585};
constexpr double gl7_w[] = {
    0.1294849661688697,
    0.2797053914892766,
    0.3818300505051189,
    0.4179591836734694,
    0.3818300505051189,
    0.2797053914892766,
    0.1294849661688697};

// ---------- order 8 ----------
constexpr double gl8_x[] = {
    -0.9602898564975363,
    -0.7966664774136267,
    -0.5255324099163290,
    -0.1834346424956498,
    0.1834346424956498,
    0.5255324099163290,
    0.7966664774136267,
    0.9602898564975363};
constexpr double gl8_w[] = {
    0.1012285362903763,
    0.2223810344533745,
    0.3137066458778873,
    0.3626837833783620,
    0.3626837833783620,
    0.3137066458778873,
    0.2223810344533745,
    0.1012285362903763};

// ---------- order 9 ----------
constexpr double gl9_x[] = {
    -0.9681602395076261,
    -0.8360311073266358,
    -0.6133714327005904,
    -0.3242534234038089,
    0.0,
    0.3242534234038089,
    0.6133714327005904,
    0.8360311073266358,
    0.9681602395076261};
constexpr double gl9_w[] = {
    0.0812743883615744,
    0.1806481606948574,
    0.2606106964029354,
    0.3123470770400029,
    0.3302393550012598,
    0.3123470770400029,
    0.2606106964029354,
    0.1806481606948574,
    0.0812743883615744};

// ---------- order 10 ----------
constexpr double gl10_x[] = {
    -0.9739065285171717,
    -0.8650633666889845,
    -0.6794095682990244,
    -0.4333953941292472,
    -0.1488743389816312,
    0.1488743389816312,
    0.4333953941292472,
    0.6794095682990244,
    0.8650633666889845,
    0.9739065285171717};
constexpr double gl10_w[] = {
    0.0666713443086881,
    0.1494513491505806,
    0.2190863625159820,
    0.2692667193099963,
    0.2955242247147529,
    0.2955242247147529,
    0.2692667193099963,
    0.2190863625159820,
    0.1494513491505806,
    0.0666713443086881};

// ---------- order 11 ----------
constexpr double gl11_x[] = {
    -0.9782286581460570,
    -0.8870625997680953,
    -0.7301520055740494,
    -0.5190961292068118,
    -0.2695431559523450,
    0.0,
    0.2695431559523450,
    0.5190961292068118,
    0.7301520055740494,
    0.8870625997680953,
    0.9782286581460570};
constexpr double gl11_w[] = {
    0.0556685671161737,
    0.1255803694649046,
    0.1862902109277343,
    0.2331937645919905,
    0.2628045445102467,
    0.2729250867779006,
    0.2628045445102467,
    0.2331937645919905,
    0.1862902109277343,
    0.1255803694649046,
    0.0556685671161737};

// ---------- order 12 ----------
constexpr double gl12_x[] = {
    -0.9815606342467192,
    -0.9041172563704749,
    -0.7699026741943047,
    -0.5873179542866175,
    -0.3678314989981802,
    -0.1252334085114689,
    0.1252334085114689,
    0.3678314989981802,
    0.5873179542866175,
    0.7699026741943047,
    0.9041172563704749,
    0.9815606342467192};
constexpr double gl12_w[] = {
    0.0471753363865118,
    0.1069393259953184,
    0.1600783285433462,
    0.2031674267230659,
    0.2334925365383548,
    0.2491470458134028,
    0.2491470458134028,
    0.2334925365383548,
    0.2031674267230659,
    0.1600783285433462,
    0.1069393259953184,
    0.0471753363865118};

// ---------- order 13 ----------
constexpr double gl13_x[] = {
    -0.9841830547185881,
    -0.9175983992229779,
    -0.8015780907333099,
    -0.6423493394403402,
    -0.4484927510364469,
    -0.2304583159551348,
    0.0,
    0.2304583159551348,
    0.4484927510364469,
    0.6423493394403402,
    0.8015780907333099,
    0.9175983992229779,
    0.9841830547185881};
constexpr double gl13_w[] = {
    0.0404840047653159,
    0.0921214998377284,
    0.1388735102197872,
    0.1781459807619457,
    0.2078160475368885,
    0.2262831802628972,
    0.2325515532308739,
    0.2262831802628972,
    0.2078160475368885,
    0.1781459807619457,
    0.1388735102197872,
    0.0921214998377284,
    0.0404840047653159};

// ---------- order 14 ----------
constexpr double gl14_x[] = {
    -0.9862838086968123,
    -0.9284348836635735,
    -0.8272013150697650,
    -0.6872929048116855,
    -0.5152486363581541,
    -0.3191123689278897,
    -0.1080549487073437,
    0.1080549487073437,
    0.3191123689278897,
    0.5152486363581541,
    0.6872929048116855,
    0.8272013150697650,
    0.9284348836635735,
    0.9862838086968123};
constexpr double gl14_w[] = {
    0.0351194603317519,
    0.0801580871597602,
    0.1215185706879032,
    0.1572031671581935,
    0.1855383974779378,
    0.2051984637212956,
    0.2152638534631578,
    0.2152638534631578,
    0.2051984637212956,
    0.1855383974779378,
    0.1572031671581935,
    0.1215185706879032,
    0.0801580871597602,
    0.0351194603317519};

// ---------- order 15 ----------
constexpr double gl15_x[] = {
    -0.9879925180204854,
    -0.9372733924007060,
    -0.8482065834104272,
    -0.7244177313601700,
    -0.5709721726085388,
    -0.3941513470775634,
    -0.2011940939974345,
    0.0,
    0.2011940939974345,
    0.3941513470775634,
    0.5709721726085388,
    0.7244177313601700,
    0.8482065834104272,
    0.9372733924007060,
    0.9879925180204854};
constexpr double gl15_w[] = {
    0.0307532419961173,
    0.0703660474881081,
    0.1071592204671719,
    0.1395706779261543,
    0.1662692058169939,
    0.1861610000155622,
    0.1984314853271116,
    0.2025782419255613,
    0.1984314853271116,
    0.1861610000155622,
    0.1662692058169939,
    0.1395706779261543,
    0.1071592204671719,
    0.0703660474881081,
    0.0307532419961173};

// ---------- order 16 ----------
constexpr double gl16_x[] = {
    -0.9894009349916499,
    -0.9445750230732326,
    -0.8656312023878318,
    -0.7554044083550030,
    -0.6178762444026438,
    -0.4580167776572274,
    -0.2816035507792589,
    -0.0950125098376374,
    0.0950125098376374,
    0.2816035507792589,
    0.4580167776572274,
    0.6178762444026438,
    0.7554044083550030,
    0.8656312023878318,
    0.9445750230732326,
    0.9894009349916499};
constexpr double gl16_w[] = {
    0.0271524594117541,
    0.0622535239386479,
    0.0951585116824928,
    0.1246289712555339,
    0.1495959888165767,
    0.1691565193950025,
    0.1826034150449236,
    0.1894506104550685,
    0.1894506104550685,
    0.1826034150449236,
    0.1691565193950025,
    0.1495959888165767,
    0.1246289712555339,
    0.0951585116824928,
    0.0622535239386479,
    0.0271524594117541};

// ---------- order 17 ----------
constexpr double gl17_x[] = {
    -0.9905754753144174,
    -0.9506755217687678,
    -0.8802391537269859,
    -0.7815140038968014,
    -0.6576711592166907,
    -0.5126905370864769,
    -0.3512317634538763,
    -0.1784841814958479,
    0.0,
    0.1784841814958479,
    0.3512317634538763,
    0.5126905370864769,
    0.6576711592166907,
    0.7815140038968014,
    0.8802391537269859,
    0.9506755217687678,
    0.9905754753144174};
constexpr double gl17_w[] = {
    0.0241483028685479,
    0.0554595293739872,
    0.0850361483171792,
    0.1118838471934040,
    0.1351363684685255,
    0.1540457610768103,
    0.1680041021564500,
    0.1765627053669926,
    0.1794464703562065,
    0.1765627053669926,
    0.1680041021564500,
    0.1540457610768103,
    0.1351363684685255,
    0.1118838471934040,
    0.0850361483171792,
    0.0554595293739872,
    0.0241483028685479};

// ---------- order 18 ----------
constexpr double gl18_x[] = {
    -0.9915651684209309,
    -0.9558239495713977,
    -0.8926024664975557,
    -0.8037049589725231,
    -0.6916870430603532,
    -0.5597708310739475,
    -0.4117511614628426,
    -0.2518862256915055,
    -0.0847750130417353,
    0.0847750130417353,
    0.2518862256915055,
    0.4117511614628426,
    0.5597708310739475,
    0.6916870430603532,
    0.8037049589725231,
    0.8926024664975557,
    0.9558239495713977,
    0.9915651684209309};
constexpr double gl18_w[] = {
    0.0216160135264833,
    0.0497145488949698,
    0.0764257302548891,
    0.1009420441062872,
    0.1225552067114785,
    0.1406429146706507,
    0.1546846751262652,
    0.1642764837458327,
    0.1691423829631436,
    0.1691423829631436,
    0.1642764837458327,
    0.1546846751262652,
    0.1406429146706507,
    0.1225552067114785,
    0.1009420441062872,
    0.0764257302548891,
    0.0497145488949698,
    0.0216160135264833};

// ---------- rule table ----------
constexpr std::array<GaussLegendreRule<double>, 18> gauss_legendre_rules = {{
    {1, 1, gl1_x, gl1_w},
    {2, 2, gl2_x, gl2_w},
    {3, 3, gl3_x, gl3_w},
    {4, 4, gl4_x, gl4_w},
    {5, 5, gl5_x, gl5_w},
    {6, 6, gl6_x, gl6_w},
    {7, 7, gl7_x, gl7_w},
    {8, 8, gl8_x, gl8_w},
    {9, 9, gl9_x, gl9_w},
    {10, 10, gl10_x, gl10_w},
    {11, 11, gl11_x, gl11_w},
    {12, 12, gl12_x, gl12_w},
    {13, 13, gl13_x, gl13_w},
    {14, 14, gl14_x, gl14_w},
    {15, 15, gl15_x, gl15_w},
    {16, 16, gl16_x, gl16_w},
    {17, 17, gl17_x, gl17_w},
    {18, 18, gl18_x, gl18_w},
}};

} // namespace htool

#endif
