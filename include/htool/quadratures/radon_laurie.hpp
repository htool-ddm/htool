#ifndef HTOOL_QUADRATURES_RADON_LAURIE_HPP
#define HTOOL_QUADRATURES_RADON_LAURIE_HPP

// Based on the article: Laurie, 1982 https://doi.org/10.1145/355993.356001.
// Tabulated values from https://github.com/zmoitier/HAdaptiveIntegration.jl

#include "quadrature.hpp"
#include <array>
#include <cstddef>
#include <string>
namespace htool {

template <typename T>
struct RadonRule {
    inline static const std::string name = "Radon";
    std::size_t degree;
    std::size_t nb_points;
    const QuadPoint<T, 2> *quad_points;
};

template <typename T>
struct LaurieRule {
    inline static const std::string name = "Laurie";
    std::size_t degree;
    std::size_t nb_points;
    const QuadPoint<T, 2> *quad_points;
};

template <typename T>
constexpr QuadPoint<T, 2> radon[] = {
    {{T(0.3333333333333333333333333333333333333333333333333333333333333333333333333333348), T(0.3333333333333333333333333333333333333333333333333333333333333333333333333333348)}, T(0.1124999999999999999999999999999999999999999999999999999999999999999999999999996)},
    {{T(0.7974269853530873223980252761697523438888496862182467453892927396298555325654265), T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867)}, T(0.0629695902724135762978419727500906668288196159561285038222551775974527153783598)},
    {{T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867), T(0.7974269853530873223980252761697523438888496862182467453892927396298555325654265)}, T(0.0629695902724135762978419727500906668288196159561285038222551775974527153783598)},
    {{T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867), T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867)}, T(0.0629695902724135762978419727500906668288196159561285038222551775974527153783598)},
    {{T(0.05971587178976982045911758097310479896829317092461039746785011751300161029171882), T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406)}, T(0.06619707639425309036882469391657599983784705071053816284441148906921395128830629)},
    {{T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406), T(0.05971587178976982045911758097310479896829317092461039746785011751300161029171882)}, T(0.06619707639425309036882469391657599983784705071053816284441148906921395128830629)},
    {{T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406), T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406)}, T(0.06619707639425309036882469391657599983784705071053816284441148906921395128830629)}};

template <typename T>
constexpr QuadPoint<T, 2> laurie[] = {
    {{T(0.3333333333333333333333333333333333333333333333333333333333333333333333333333348), T(0.3333333333333333333333333333333333333333333333333333333333333333333333333333348)}, T(0.01893054560015734165415411067800806149331579616112555544752071088518874456461607)},
    {{T(0.7974269853530873223980252761697523438888496862182467453892927396298555325654265), T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867)}, T(0.01881021270659148607215700260658383995407691889410336669994070251334830384521297)},
    {{T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867), T(0.7974269853530873223980252761697523438888496862182467453892927396298555325654265)}, T(0.01881021270659148607215700260658383995407691889410336669994070251334830384521297)},
    {{T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867), T(0.1012865073234563388009873619151238280555751568908766273053536301850722337172867)}, T(0.01881021270659148607215700260658383995407691889410336669994070251334830384521297)},
    {{T(0.05971587178976982045911758097310479896829317092461039746785011751300161029171882), T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406)}, T(0.03917867612205866877772300044712309002571437690317060264183043710988867491552438)},
    {{T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406), T(0.05971587178976982045911758097310479896829317092461039746785011751300161029171882)}, T(0.03917867612205866877772300044712309002571437690317060264183043710988867491552438)},
    {{T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406), T(0.4701420641051150897704412095134476005158534145376948012660749412434991948541406)}, T(0.03917867612205866877772300044712309002571437690317060264183043710988867491552438)},
    {{T(0.9410382782311208665596303797019388487106860395203416023386125028151647020029081), T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486)}, T(0.006722133687582700949055532526590556751243165821525704544824060777814715984707872)},
    {{T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486), T(0.9410382782311208665596303797019388487106860395203416023386125028151647020029081)}, T(0.006722133687582700949055532526590556751243165821525704544824060777814715984707872)},
    {{T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486), T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486)}, T(0.006722133687582700949055532526590556751243165821525704544824060777814715984707872)},
    {{T(0.5357953464498992646629508988845634681138160011646473266321284881184061476038248), T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876)}, T(0.05813573982848294819737435282749222627784677970688531852890489430065582858804563)},
    {{T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876), T(0.5357953464498992646629508988845634681138160011646473266321284881184061476038248)}, T(0.05813573982848294819737435282749222627784677970688531852890489430065582858804563)},
    {{T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876), T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876)}, T(0.05813573982848294819737435282749222627784677970688531852890489430065582858804563)},
    {{T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486), T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876)}, T(0.01875486122761587439281937068310379991334007997696991121766316750161478090581462)},
    {{T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486), T(0.7384168123405100656112906392932511584122510203424944644853704954667854248033665)}, T(0.01875486122761587439281937068310379991334007997696991121766316750161478090581462)},
    {{T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876), T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486)}, T(0.01875486122761587439281937068310379991334007997696991121766316750161478090581462)},
    {{T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876), T(0.7384168123405100656112906392932511584122510203424944644853704954667854248033665)}, T(0.01875486122761587439281937068310379991334007997696991121766316750161478090581462)},
    {{T(0.7384168123405100656112906392932511584122510203424944644853704954667854248033665), T(0.02948086088443956672018481014903057564465698023982919883069374859241764899854486)}, T(0.01875486122761587439281937068310379991334007997696991121766316750161478090581462)},
    {{T(0.7384168123405100656112906392932511584122510203424944644853704954667854248033665), T(0.2321023267750503676685245505577182659430919994176763366839357559407969261980876)}, T(0.01875486122761587439281937068310379991334007997696991121766316750161478090581462)},
};

// ---------- rule table ----------
template <typename T>
constexpr std::array<RadonRule<T>, 1> radon_rules = {{
    {5, 7, radon<T>},
}};

template <typename T>
constexpr std::array<LaurieRule<T>, 1> laurie_rules = {{
    {8, 19, laurie<T>},
}};
} // namespace htool

#endif
