#ifndef HTOOL_QUADRATURES_DUNAVANT_HPP
#define HTOOL_QUADRATURES_DUNAVANT_HPP

#include "quadratures.hpp"

namespace htool {

template <typename T>
struct DunavantRule {
    int degree;
    int n_points;
    const QuadPoint<T, 2> *points;
};

// ---------- Degree 1 (1 point) ----------
constexpr QuadPoint<double, 2> dunavant_deg1[] = {
    {1.0 / 3.0, 1.0 / 3.0, 0.5}};

// ---------- Degree 2 (3 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg2[] = {
    {1.0 / 6.0, 1.0 / 6.0, 1.0 / 6.0},
    {2.0 / 3.0, 1.0 / 6.0, 1.0 / 6.0},
    {1.0 / 6.0, 2.0 / 3.0, 1.0 / 6.0}};

// ---------- Degree 3 (4 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg3[] = {
    {1.0 / 3.0, 1.0 / 3.0, -27.0 / 96.0},
    {0.2, 0.2, 25.0 / 96.0},
    {0.6, 0.2, 25.0 / 96.0},
    {0.2, 0.6, 25.0 / 96.0}};

// ---------- Degree 4 (6 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg4[] = {
    {0.445948490915965, 0.445948490915965, 0.111690794839005},
    {0.108103018168070, 0.445948490915965, 0.111690794839005},
    {0.445948490915965, 0.108103018168070, 0.111690794839005},
    {0.091576213509771, 0.091576213509771, 0.054975871827661},
    {0.816847572980459, 0.091576213509771, 0.054975871827661},
    {0.091576213509771, 0.816847572980459, 0.054975871827661}};

// ---------- Degree 5 (7 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg5[] = {
    {1.0 / 3.0, 1.0 / 3.0, 0.1125},
    {0.470142064105115, 0.470142064105115, 0.066197076394253},
    {0.059715871789770, 0.470142064105115, 0.066197076394253},
    {0.470142064105115, 0.059715871789770, 0.066197076394253},
    {0.101286507323456, 0.101286507323456, 0.062969590272413},
    {0.797426985353087, 0.101286507323456, 0.062969590272413},
    {0.101286507323456, 0.797426985353087, 0.062969590272413}};

// ---------- Degree 6 (12 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg6[] = {
    {0.249286745170910, 0.249286745170910, 0.058393137863189},
    {0.501426509658179, 0.249286745170910, 0.058393137863189},
    {0.249286745170910, 0.501426509658179, 0.058393137863189},
    {0.063089014491502, 0.063089014491502, 0.025422453185103},
    {0.873821971016996, 0.063089014491502, 0.025422453185103},
    {0.063089014491502, 0.873821971016996, 0.025422453185103},
    {0.310352451033785, 0.636502499121399, 0.041425537809187},
    {0.636502499121399, 0.053145049844816, 0.041425537809187},
    {0.053145049844816, 0.310352451033785, 0.041425537809187},
    {0.636502499121399, 0.310352451033785, 0.041425537809187},
    {0.310352451033785, 0.053145049844816, 0.041425537809187},
    {0.053145049844816, 0.636502499121399, 0.041425537809187}};

// ---------- Degree 7 (13 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg7[] = {
    {0.333333333333333, 0.333333333333333, -0.074785022233841},
    {0.479308067841920, 0.479308067841920, 0.087807628716604},
    {0.041383864316160, 0.479308067841920, 0.087807628716604},
    {0.479308067841920, 0.041383864316160, 0.087807628716604},
    {0.260345966079040, 0.260345966079040, 0.026673617804419},
    {0.479308067841920, 0.260345966079040, 0.026673617804419},
    {0.260345966079040, 0.479308067841920, 0.026673617804419},
    {0.869739794195568, 0.065130102902216, 0.038556880445128},
    {0.065130102902216, 0.869739794195568, 0.038556880445128},
    {0.065130102902216, 0.065130102902216, 0.038556880445128},
    {0.638444188569810, 0.312865496004875, 0.038556880445128},
    {0.312865496004875, 0.048690315425316, 0.038556880445128},
    {0.048690315425316, 0.638444188569810, 0.038556880445128}};

// ---------- Degree 8 (16 points) ----------
constexpr QuadPoint<double, 2> dunavant_deg8[] = {
    {0.333333333333333, 0.333333333333333, 0.072157803838894},
    {0.081414823414554, 0.459292588292723, 0.047545817133642},
    {0.459292588292723, 0.081414823414554, 0.047545817133642},
    {0.459292588292723, 0.459292588292723, 0.047545817133642},
    {0.658861384496480, 0.170569307751760, 0.051608685267359},
    {0.170569307751760, 0.658861384496480, 0.051608685267359},
    {0.170569307751760, 0.170569307751760, 0.051608685267359},
    {0.898905543365938, 0.050547228317031, 0.016229248811599},
    {0.050547228317031, 0.898905543365938, 0.016229248811599},
    {0.050547228317031, 0.050547228317031, 0.016229248811599},
    {0.008394777409958, 0.263112829634638, 0.013615157087217},
    {0.263112829634638, 0.728492392955404, 0.013615157087217},
    {0.728492392955404, 0.008394777409958, 0.013615157087217},
    {0.263112829634638, 0.008394777409958, 0.013615157087217},
    {0.728492392955404, 0.263112829634638, 0.013615157087217},
    {0.008394777409958, 0.728492392955404, 0.013615157087217}};

constexpr DunavantRule<double> dunavant_rules[] = {
    {1, 1, dunavant_deg1},
    {2, 3, dunavant_deg2},
    {3, 4, dunavant_deg3},
    {4, 6, dunavant_deg4},
    {5, 7, dunavant_deg5},
    {6, 12, dunavant_deg6},
    {7, 13, dunavant_deg7},
    {8, 16, dunavant_deg8},
    // {9, 19, dunavant_deg9},
    // {10, 25, dunavant_deg10},
    // {11, 27, dunavant_deg11},
    // {12, 33, dunavant_deg12},
    // {13, 37, dunavant_deg13},
    // {14, 42, dunavant_deg14},
    // {15, 49, dunavant_deg15},
    // {16, 55, dunavant_deg16},
    // {17, 60, dunavant_deg17},
    // {18, 67, dunavant_deg18},
    // {19, 73, dunavant_deg19},
    // {20, 79, dunavant_deg20}
};

} // namespace htool
#endif
